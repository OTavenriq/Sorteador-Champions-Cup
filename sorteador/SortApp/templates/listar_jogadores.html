{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container-fluid py-5 champions-bg">

    <!-- Título -->
    <div class="text-center mb-5">
        <h1 class="fw-bold text-light champions-title">
            Jogadores
        </h1>
        <p class="text-secondary">Cedro Champions Cup</p>
    </div>

    <!-- Ações -->
    <div class="d-flex flex-wrap justify-content-center gap-3 mb-5">
        <a href="{% url 'cadastrar_jogador' %}" class="btn btn-success px-4">
            + Adicionar Jogador
        </a>

        <a href="{% url 'listar_times_completos' %}" class="btn btn-primary px-4">
            Ver Times e Jogadores
        </a>

        <form method="post" action="{% url 'excluir_todos_jogadores' %}"
              onsubmit="return confirm('Tem certeza que deseja excluir TODOS os jogadores?');">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger px-4">
                Excluir Todos
            </button>
        </form>
    </div>

    {% if jogadores %}

        {% regroup jogadores by classificacao as potes %}

        {% for pote in potes %}
        <div class="row justify-content-center mb-5">
            <div class="col-lg-10">

                <div class="champions-card">

                    <!-- Cabeçalho do Pote -->
                    <div class="champions-card-header">
                        Pote {{ pote.grouper }}
                    </div>

                    <!-- Tabela -->
                    <div class="table-responsive">
                        <table class="table table-borderless champions-table mb-0">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Overall</th>
                                    <th>Time</th>
                                    <th class="text-end">Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for j in pote.list %}
                                <tr>
                                    <td class="fw-semibold text-light">
                                        {{ j.nome }}
                                    </td>
                                    <td class="text-light">
                                        {{ j.overall }}
                                    </td>
                                    <td class="text-light">
                                        {% if j.time %}
                                            {{ j.time.nome }}
                                        {% else %}
                                            —
                                        {% endif %}
                                    </td>
                                    <td class="text-end">
                                        <a href="{% url 'editar_jogador' j.id %}"
                                           class="edit-icon"
                                           title="Editar jogador">
                                            ✏️
                                        </a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>
        {% endfor %}

    {% else %}
        <div class="alert alert-warning text-center">
            Não há jogadores cadastrados.
        </div>
    {% endif %}

</div>

<style>
/* FUNDO CHAMPIONS */
.champions-bg {
    min-height: 100vh;
    background: radial-gradient(circle at top, #1b3a6f, #0a1428 70%);
}

/* TÍTULO */
.champions-title {
    font-size: 2.8rem;
    border-bottom: 3px solid #1e90ff;
    display: inline-block;
    padding-bottom: 10px;
}

/* CARD */
.champions-card {
    background: rgba(255, 255, 255, 0.06);
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    overflow: hidden;
}

/* HEADER DO CARD */
.champions-card-header {
    background: linear-gradient(to right, #1e90ff, #0a58ca);
    color: #fff;
    text-align: center;
    font-weight: bold;
    letter-spacing: 2px;
    padding: 14px;
    font-size: 1.2rem;
}

/* ===== TABELA (CORRIGIDA) ===== */
.champions-table {
    color: #ffffff;
    background-color: transparent;
}

.champions-table thead {
    background: rgba(30, 144, 255, 0.25);
}

.champions-table tbody tr {
    background: rgba(10, 20, 40, 0.6);
}

.champions-table th {
    border: none;
    color: #dbe9ff;
    background-color: transparent;
}

.champions-table td {
    border-top: 1px solid rgba(255,255,255,0.1);
    background-color: transparent;
}

.champions-table tbody tr:hover {
    background: rgba(30, 144, 255, 0.2);
}

/* ÍCONE EDITAR */
.edit-icon {
    color: #1e90ff;
    font-size: 1.2rem;
    text-decoration: none;
}

.edit-icon:hover {
    color: #63b3ff;
}
</style>

{% endblock %}
